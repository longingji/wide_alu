

(start of output generated by `regtool.py --doc`)

The tables describe each key and the type of the value. The following
types are used:

Type | Description
---- | -----------
int | integer (binary 0b, octal 0o, decimal, hex 0x)
xint | x for undefined otherwise int
bitrange | bit number as decimal integer, or bit-range as decimal integers msb:lsb
list | comma separated list enclosed in `[]`
name list | comma separated list enclosed in `[]` of one or more groups that have just name and dscr keys. e.g. `{ name: "name", desc: "description"}`
name list+ | name list that optionally contains a width
parameter list | parameter list having default value optionally
group | comma separated group of key:value enclosed in `{}`
list of group | comma separated group of key:value enclosed in `{}` the second entry of the list is the sub group format
string | string, typically short
text | string, may be multi-line enclosed in `'''` may use `**bold**`, `*italic*` or `!!Reg` markup
tuple | tuple enclosed in ()
python int | Native Python type int (generated)
python Bool | Native Python type Bool (generated)
python list | Native Python type list (generated)
python enum | Native Python type enum (generated)


Register fields are tagged using the swaccess key to describe the
permitted access and side-effects. This key must have one of these
values:


Key | Description
--- | -----------
ro | Read Only
rc | Read Only, reading clears
rw | Read/Write
r0w1c | Read zero, Write with 1 clears
rw1s | Read, Write with 1 sets
rw1c | Read, Write with 1 clears
rw0c | Read, Write with 0 clears
wo | Write Only


Register fields are tagged using the hwaccess key to describe the
permitted access from hardware logic and side-effects. This key must
have one of these values:


Key | Description
--- | -----------
hro | Read Only
hrw | Read/Write
hwo | Write Only
none | No Access Needed


The top level of the JSON is a group containing the following keys:

Key | Kind | Type | Description of Value
--- | ---- | ---- | --------------------
name | required | string | name of the component
clock_primary | required | string | name of the primary clock
bus_device | required | string | name of the bus interface for the device
registers | required | list | list of register definition groups and offset control groups
reset_primary | optional | string | primary reset used by the module
other_reset_list | optional | list | list of other resets
bus_host | optional | string | name of the bus interface as host
other_clock_list | optional | list | list of other chip clocks needed
available_input_list | optional | name list+ | list of available peripheral inputs
available_output_list | optional | name list+ | list of available peripheral outputs
available_inout_list | optional | name list+ | list of available peripheral inouts
interrupt_list | optional | name list+ | list of peripheral interrupts
inter_signal_list | optional | list | list of inter-module signals
no_auto_intr_regs | optional | string | Set to true to suppress automatic generation of interrupt registers. Defaults to false if not present.
alert_list | optional | name list+ | list of peripheral alerts
wakeup_list | optional | name list+ | list of peripheral wakeups
regwidth | optional | int | width of registers in bits (default 32)
param_list | optional | parameter list | list of parameters of the IP
scan | optional | python Bool | Indicates the module have `scanmode_i`
scan_reset | optional | python Bool | Indicates the module have `test_rst_ni`
SPDX-License-Identifier | optional | string | License ientifier (if using pure json) Only use this if unable to put this information in a comment at the top of the file.
genrnames | added by tool | python list | list of register names
genautoregs | added by tool | python Bool | Registers were generated from config info
genwennames | added by tool | python list | list of registers used as write enables
gennextoffset | added by tool | python int | offset next register would use
gensize | added by tool | python int | address space size needed for registers. Generated by tool as next power of 2.

The basic structure of a register definition file is thus:

```hjson
{
  name: "GP",
  regwidth: "32",
  registers: [
    // register definitions...
  ]
}

```



The list of registers includes register definition groups containing the following keys:

Key | Kind | Type | Description of Value
--- | ---- | ---- | --------------------
name | required | string | name of the register
desc | required | text | description of the register
fields | required | list | list of register field description groups
swaccess | optional | string | software access permission to use for fields that don't specify swaccess
hwaccess | optional | string | hardware access permission to use for fields that don't specify hwaccess
hwext | optional | string | 'true' if the register is stored out side of the register module
hwqe | optional | string | 'true' if hardware uses 'q' enable signal, which is latched signal of software write pulse.
hwre | optional | string | 'true' if hardware uses 're' signal, which is latched signal of software read pulse.
regwen | optional | string | if register is write-protected by another register, that register name should be given here. empty-string for no register write protection
resval | optional | int | reset value of full register (default 0)
tags | optional | string | tags for the register, followed by the format 'tag_name:item1:item2...'
shadowed | optional | string | 'true' if the register is shadowed
regwen_incr | optional | string | If true, regwen term increments along with current multireg count.
genresval | added by tool | python int | reset value generated from resval and fields
genresmask | added by tool | python int | mask of bits with valid reset value (not x)
genbitsused | added by tool | python int | mask of bits defined in the register
genoffset | added by tool | python int | offset address of the register
genbasebits | added by tool | python int | multireg only: mask of base bits defined
gendvrights | added by tool | string | SW Rights used in UVM reg class


The basic register definition group will follow this pattern:

```hjson
    { name: "REGA",
      desc: "Description of register",
      swaccess: "rw",
      resval: "42",
      fields: [
        // bit field definitions...
      ]
    }
```

The name and brief description are required. If the swaccess key is
provided it describes the access pattern that will be used by all
bitfields in the register that do not override with their own swaccess
key. This is a useful shortcut because in most cases a register will
have the same access restrictions for all fields. The reset value of
the register may also be provided here or in the individual fields. If
it is provided in both places then they must match, if it is provided
in neither place then the reset value defaults to zero for all except
write-only fields when it defaults to x.



In the fields list each field definition is a group itself containing the following keys:

Key | Kind | Type | Description of Value
--- | ---- | ---- | --------------------
name | required | string | name of the field (optional if only field)
desc | required | text | description of field (optional if no name)
bits | required | bitrange | bit or bit range (msb:lsb)
swaccess | optional | string | software access permission, copied from register if not provided in field. (Tool adds if not provided.)
hwaccess | optional | string | hardware access permission, copied from register if not prvided in field. (Tool adds if not provided.)
resval | optional | xint | reset value, comes from register resval if not provided in field. Zero if neither are provided and the field is readable, x if neither are provided and the field is wo. Must match if both are provided.
enum | optional | list | list of permitted enumeration groups
tags | optional | string | tags for the field, followed by the format 'tag_name:item1:item2...'
genrsvdenum | added by tool | python Bool | enum did not cover every possible value
genresval | added by tool | python int | resval for field constructed by the tool. Will be set to 0 for x.
genresvalx | added by tool | python Bool | Indicates if resval is x
genswaccess | added by tool | python enum | Software access (generated enum)
genswwraccess | added by tool | python enum | Software write access (generated enum)
genswrdaccess | added by tool | python enum | Software read access (generated enum)
genhwaccess | added by tool | python enum | Hardware access (generated Enum)
genhwqe | added by tool | python Bool | Hardware qualifier enable signal needed
genhwre | added by tool | python Bool | Hardware read enable signal needed
bitinfo | added by tool | tuple | tuple (bitfield_mask, field width, lsb)


Field names should be relatively short because they will be used
frequently (and need to fit in the register layout picture!) The field
description is expected to be longer and will most likely make use of
the Hjson ability to include multi-line strings. An example with three
fields:

```hjson
    fields: [
      { bits: "15:0",
        name: "RXS",
        desc: '''
        Last 16 oversampled values of RX. These are captured at 16x the baud
        rate clock. This is a shift register with the most recent bit in
        bit 0 and the oldest in bit 15. Only valid when ENRXS is set.
        '''
      }
      { bits: "16",
        name: "ENRXS",
        desc: '''
          If this bit is set the receive oversampled data is collected
          in the RXS field.
        '''
      }
      {bits: "20:19", name: "TXILVL",
       desc: "Trigger level for TX interrupts",
       resval: "2",
       enum: [
               { value: "0", name: "txlvl1", desc: "1 character" },
               { value: "1", name: "txlvl4", desc: "4 characters" },
               { value: "2", name: "txlvl8", desc: "8 characters" },
               { value: "3", name: "txlvl16", desc: "16 characters" }
             ]
      }
    ]
```

In all of these the swaccess parameter is inherited from the register
level, and will be added so this key is always available to the
backend. The RXS and ENRXS will default to zero reset value (unless
something different is provided for the register) and will have the
key added, but TXILVL expicitly sets its reset value as 2.

The missing bits 17 and 18 will be treated as reserved by the tool, as
will any bits between 21 and the maximum in the register.

The TXILVL is an example using an enumeration to specify all valid
values for the field. In this case all possible values are described,
if the list is incomplete then the field is marked with the rsvdenum
key so the backend can take appropriate action. (If the enum field is
more than 7 bits then the checking is not done.)



Definitions in an enumeration group contain:

Key | Kind | Type | Description of Value
--- | ---- | ---- | --------------------
name | required | string | name of the member of the enum
desc | required | text | description when field has this value
value | required | int | value of this member of the enum


The list of registers may include single entry groups to control the offset, open a window or generate registers:

Key | Kind | Type | Description of Value
--- | ---- | ---- | --------------------
reserved | optional | int | number of registers to reserve space for
skipto | optional | int | set next register offset to value
sameaddr | optional | list | list of register definition groups that share the same offset
window | optional | group | group defining an address range for something other than standard registers
multireg | optional | group | group defining registers generated from a base instance.




Registers can protect themselves from software writes by using the
register attribute regwen. When not an emptry string (the default
value), regwen indicates that another register must be true in order
to allow writes to this register.  This is useful for the prevention
of software modification.  The register-enable register (call it
REGWEN) must be one bit in width, and should default to 1 and be rw1c
for preferred security control.  This allows all writes to proceed
until at some point software disables future modifications by clearing
REGWEN. An error is reported if REGWEN does not exist, contains more
than one bit, is not `rw1c` or does not default to 1. One REGWEN can
protect multiple registers. The REGWEN register must precede those
registers that refer to it in the .hjson register list. An example:

```hjson
    { name: "REGWEN",
      desc: "Register write enable for a bank of registers",
      swaccess: "rw1c",
      fields: [ { bits: "0", resval: "1" } ]
    }
    { name: "REGA",
      swaccess: "rw",
      regwen: "REGWEN",
      ...
    }
    { name: "REGB",
      swaccess: "rw",
      regwen: "REGWEN",
      ...
    }
```


A window defines an open region of the register space that can be used
for things that are not registers (for example access to a buffer ram).


Key | Kind | Type | Description of Value
--- | ---- | ---- | --------------------
name | required | string | Name of the window
desc | required | text | description of the window
items | required | int | size in fieldaccess width words of the window
swaccess | required | string | software access permitted
byte-write | optional | string | True if byte writes are supported. Defaults to false if not present.
validbits | optional | int | Number of valid data bits within regwidth sized word. Defaults to regwidth. If smaller than the regwidth then in each word of the window bits [regwidth-1:validbits] are unused and bits [validbits-1:0] are valid.
noalign | optional | string | Set to True to prevent tool aligning the base address of the window. Defaults to false if not present.
unusual | optional | string | True if window has unusual parameters (set to prevent Unusual: errors).Defaults to false if not present.
genbyte-write | added by tool | python Bool | generated boolean for byte-write
genvalidbits | added by tool | python int | valid data width
genoffset | added by tool | python int | base offset address of the window (aligned for size)
genswaccess | added by tool | python enum | Software access (gen enum)
genswwraccess | added by tool | python enum | Software write access (gen enum)
genswrdaccess | added by tool | python enum | Software read access (gen enum)


The multireg expands on the register required fields and will generate
a list of the generated registers (that contain all required and
generated keys for an actual register).


Key | Kind | Type | Description of Value
--- | ---- | ---- | --------------------
name | required | string | base name of the registers
desc | required | text | description of the registers
count | required | string | number of instances to generate. This field can be integer or string matching from param_list.
cname | required | string | base name for each instance, mostly useful for refering to instance in messages.
fields | required | list | list of register field description groups. Describes bit positions used for base instance.
swaccess | optional | string | software access permission to use for fields that don't specify swaccess
hwaccess | optional | string | hardware access permission to use for fields that don't specify hwaccess
hwext | optional | string | 'true' if the register is stored out side of the register module
hwqe | optional | string | 'true' if hardware uses 'q' enable signal, which is latched signal of software write pulse.
hwre | optional | string | 'true' if hardware uses 're' signal, which is latched signal of software read pulse.
regwen | optional | string | if register is write-protected by another register, that register name should be given here. empty-string for no register write protection
resval | optional | int | reset value of full register (default 0)
tags | optional | string | tags for the register, followed by the format 'tag_name:item1:item2...'
shadowed | optional | string | 'true' if the register is shadowed
regwen_incr | optional | string | If true, regwen term increments along with current multireg count.
genregs | added by tool | list | generated list of registers with required and added keys


(end of output generated by `regtool.py --doc`)

